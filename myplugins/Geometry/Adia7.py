import pyscf
from pyscf import gto


class GeometryBase():
    def __init__(self):
        self.names = []
        self.unit = 'A'
        self.geom = {}
        self.spin = {}
        self.charge = {}
        pass

    def get_names(self):
        return self.names

    def get_geom(self, name):
        return self.geom[name]
    
    def get_spin(self, name):
        return self.spin[name]
    
    def get_charge(self, name):
        return self.charge[name]

    def get_molecule(self, name, 
                     basis='ccpvtz', 
                     charge=-999999,
                     spin=-999999,
                     symmetry=False, 
                     verbose=3):
        if name not in self.names:
            raise ValueError(f"Name {name} not found in geometry database.")
        if charge == -999999:
            charge = self.get_charge(name)
        if spin == -999999:
            spin = self.get_spin(name)
        mol = gto.M(
                unit = self.unit,
                atom = self.get_geom(name),
                charge = charge,
                spin = spin,
                basis = basis,
                symmetry = symmetry,
                verbose = verbose
                )
        return mol



class Adia7(GeometryBase):

    def __init__(self):
        super().__init__()
        self.unit = 'A'
        self.geom_init()
        self.names = list(self.geom.keys())
        self.spin_init()
        self.charge_init()
        pass


    def geom_init(self):

        self.geom['001_a_S1'] = """
        N         -0.00296        0.00032        0.25445
        N          2.26911       -0.58776       -0.01790
        N          0.58158       -2.27259       -0.01854
        N         -1.64190       -1.67500       -0.04459
        N         -2.25712        0.62877       -0.07128
        N         -0.62768        2.25560       -0.07067
        N          1.67508        1.63668       -0.04334
        C          1.35167        0.35967        0.04722
        C          1.85128       -1.85680        0.02491
        C         -0.36441       -1.35366        0.04657
        C         -2.53272       -0.67851       -0.02658
        C         -0.99006        0.98908        0.01953
        C          0.68002        2.52910       -0.02538
        H          2.61546       -2.62222        0.02577
        H          0.96091        3.57341       -0.04520
        H         -3.57747       -0.95772       -0.04691
        """

        self.geom['002_a_T1'] = """
        N         -0.00154       -0.00105        0.09767
        N          2.27537       -0.58735        0.01160
        N          0.58115       -2.27886        0.01095
        N         -1.64533       -1.68048       -0.01509
        N         -2.26300        0.63246       -0.04192
        N         -0.63138        2.26147       -0.04130
        N          1.68057        1.64010       -0.01381
        C          1.35754        0.36098        0.02604
        C          1.85267       -1.85820        0.02973
        C         -0.36572       -1.35952        0.02539
        C         -2.53470       -0.67900       -0.02174
        C         -0.99400        0.99304       -0.00181
        C          0.68051        2.53108       -0.02051
        H          2.61652       -2.62328        0.03544
        H          0.96124        3.57504       -0.03541
        H         -3.57910       -0.95805       -0.03714
        """

        self.geom['003_b_S1'] = """
        O          9.43859       -3.96619        0.68956
        C          8.51398       -3.01768        0.54258
        N          7.48192       -3.27372       -0.26286
        C          6.64253       -2.28557       -0.50682
        N          5.56837       -2.46872       -1.24849
        C          4.74296       -1.43115       -1.40158
        N          4.76818       -0.29926       -0.69917
        C          5.83059       -0.08250        0.04669
        N          5.91808        0.98897        0.81298
        C          7.00094        1.11115        1.58235
        N          7.89355        0.15622        1.83890
        C          7.84635       -0.92783        1.09029
        N          8.66063       -1.93917        1.31145
        N          6.93139       -0.98654       -0.00517
        O          7.16051        2.25135        2.25290
        O          3.72628       -1.56531       -2.25335
        H          9.18799       -4.71355        0.13139
        H          6.42125        2.83195        2.03012
        H          3.78547       -2.44450       -2.64886
        """

        self.geom['004_b_T1'] = """
        O          9.43787       -3.96026        0.71867
        C          8.51944       -3.01791        0.53468
        N          7.54301       -3.26738       -0.31309
        C          6.61640       -2.31431       -0.49756
        N          5.60079       -2.44291       -1.31083
        C          4.73466       -1.43421       -1.42153
        N          4.80554       -0.26338       -0.75834
        C          5.80049       -0.08946        0.06307
        N          5.95911        1.03756        0.76761
        C          7.00454        1.11217        1.57435
        N          7.95266        0.18966        1.79030
        C          7.81544       -0.94072        1.09980
        N          8.72295       -1.90234        1.26599
        N          6.77214       -1.10504        0.24648
        O          7.15771        2.22986        2.26935
        O          3.68932       -1.56660       -2.25867
        H          9.20700       -4.71211        0.15673
        H          6.42821        2.82319        2.04310
        H          3.75232       -2.43784       -2.66720
        """

        self.geom['005_c_S1'] = """
N          1.23139        2.26684       -0.03134
C         -0.06971        2.60767       -0.03080
N         -1.09437        1.75632       -0.02104
C         -0.82492        0.47027       -0.01082
C         -1.81132       -0.52459        0.00006
C         -1.43844       -1.87546        0.01056
N         -0.16379       -2.26967        0.01059
C          0.79867       -1.36727        0.00057
C          2.14128       -1.75015        0.00026
C          3.16387       -0.80550       -0.01041
C          2.86326        0.54558       -0.02109
C          1.53259        0.99023       -0.02128
N          0.51411        0.01391       -0.01017
C         -3.18789       -0.15474        0.00030
N         -4.31060        0.08396        0.00103
H          3.62411        1.31217       -0.02971
H         -2.19723       -2.64579        0.01905
H          2.33583       -2.81254        0.00870
H          4.19488       -1.12957       -0.01041
H         -0.30284        3.66287       -0.03913
        """

        self.geom['006_c_T1'] = """
N          1.23024        2.26763       -0.03135
C         -0.06764        2.60475       -0.03083
N         -1.09607        1.75440       -0.02102
C         -0.82530        0.46984       -0.01085
C         -1.81095       -0.52522        0.00007
C         -1.43821       -1.87686        0.01053
N         -0.16209       -2.27064        0.01056
C          0.79813       -1.36642        0.00049
C          2.14194       -1.74757        0.00021
C          3.16798       -0.80670       -0.01038
C          2.86091        0.54535       -0.02104
C          1.53207        0.98658       -0.02128
N          0.51045        0.01495       -0.01034
C         -3.18654       -0.15167        0.00036
N         -4.30882        0.08923        0.00113
H          3.61835        1.31552       -0.02961
H         -2.19609       -2.64760        0.01904
H          2.33307       -2.81088        0.00871
H          4.19855       -1.13029       -0.01034
H         -0.30107        3.66013       -0.03917
        """

        self.geom['007_d_S1'] = """
C          9.19179       -4.74207        0.29756
C          8.28537       -3.55706        0.27142
N          7.40196       -3.45144       -0.72578
C          6.56891       -2.43098       -0.73148
N          5.68303       -2.26922       -1.69448
C          4.87958       -1.20776       -1.63745
N          4.94403       -0.21097       -0.73012
C          5.81769       -0.33176        0.24294
C          5.99972        0.67060        1.20127
C          6.97361        0.54782        2.19257
C          7.80958       -0.55867        2.20553
C          7.66263       -1.59275        1.26307
N          8.46956       -2.62357        1.23404
N          6.58827       -1.50690        0.35205
N          3.95955       -1.06215       -2.63499
H         10.21849       -4.43638        0.08128
H          8.87462       -5.47220       -0.44179
H          9.19408       -5.19360        1.29039
H          5.36188        1.53822        1.11956
H          7.09975        1.33121        2.92603
H          8.61020       -0.67405        2.92133
H          3.75909       -1.87809       -3.18693
H          3.21784       -0.40249       -2.47848
        """

        self.geom['008_d_T1'] = """
C          9.18113       -4.73984        0.29386
C          8.29705       -3.53605        0.29647
N          7.33943       -3.50655       -0.65415
C          6.53928       -2.44764       -0.67425
N          5.57939       -2.36825       -1.58863
C          4.80908       -1.27928       -1.55468
N          4.89659       -0.24859       -0.69436
C          5.84680       -0.31090        0.22236
C          6.03546        0.69656        1.16795
C          7.05069        0.63039        2.14827
C          7.87410       -0.49250        2.14369
C          7.72984       -1.52997        1.22084
N          8.51508       -2.60536        1.21422
N          6.69874       -1.43726        0.24298
N          3.83639       -1.19603       -2.47879
H          9.91552       -4.67604        1.09140
H          9.68316       -4.82217       -0.67135
H          8.57462       -5.63872        0.41434
H          5.35267        1.53173        1.10078
H          7.18030        1.41925        2.87031
H          8.67438       -0.62104        2.86006
H          3.72950       -1.94077       -3.14331
H          3.23206       -0.39522       -2.49049
        """
        self.geom['009_e_S1'] = """
C         -1.00467        0.82115        1.20184
C         -1.02099        1.85411        2.19889
C          0.03365        2.64166        2.51884
C          1.40394        2.70270        2.01216
C          2.05530        1.99113        1.06125
C          1.47616        0.93174        0.28436
C         -1.99992       -0.08919        0.73965
C          0.14436        0.53677        0.45509
C          1.99992        0.08919       -0.73965
C         -1.47616       -0.93174       -0.28437
C         -0.14436       -0.53677       -0.45509
C          1.00467       -0.82115       -1.20184
C         -2.05530       -1.99113       -1.06125
C          1.02099       -1.85411       -2.19889
C         -1.40394       -2.70270       -2.01216
C         -0.03365       -2.64166       -2.51884
H          3.01389        0.13432       -1.11457
H          1.94653       -2.01968       -2.73960
H          0.15713       -3.37150       -3.29748
H         -1.99678       -3.46748       -2.50101
H          1.99679        3.46748        2.50101
H         -3.01389       -0.13432        1.11457
H          3.09354        2.24417        0.87567
H         -3.09355       -2.24417       -0.87567
H         -1.94653        2.01968        2.73960
H         -0.15713        3.37150        3.29748
        """
        self.geom['010_e_T1'] = """
C         -1.00443        0.82111        1.20167
C         -1.02134        1.85401        2.19892
C          0.03349        2.64127        2.51853
C          1.40390        2.70232        2.01180
C          2.05559        1.99106        1.06104
C          1.47588        0.93168        0.28440
C         -1.99942       -0.08917        0.73945
C          0.14385        0.53491        0.45350
C          1.99942        0.08917       -0.73945
C         -1.47588       -0.93168       -0.28441
C         -0.14385       -0.53491       -0.45350
C          1.00443       -0.82111       -1.20167
C         -2.05560       -1.99106       -1.06104
C          1.02134       -1.85401       -2.19892
C         -1.40390       -2.70232       -2.01180
C         -0.03349       -2.64127       -2.51853
H          3.01360        0.13430       -1.11445
H          1.94678       -2.01974       -2.73977
H          0.15703       -3.37119       -3.29717
H         -1.99654       -3.46717       -2.50081
H          1.99654        3.46717        2.50081
H         -3.01360       -0.13430        1.11445
H          3.09384        2.24426        0.87563
H         -3.09384       -2.24426       -0.87563
H         -1.94678        2.01974        2.73977
H         -0.15703        3.37119        3.29717
        """
        self.geom['011_f_S1'] = """
C          0.24979        2.21235        0.14022
C          3.44513        0.97729       -0.28893
C          0.41755        0.81989        0.05655
C          4.82825        1.04251       -0.27941
C          5.58033       -0.07702        0.05214
C          4.93273       -1.26310        0.37351
C          3.54970       -1.32961        0.36508
C         -4.38049       -2.63927       -0.13956
C         -4.18838        2.22185        0.12034
C          1.32284       -0.26613        0.02169
C          0.52810       -1.44863       -0.03316
C         -0.85636       -1.14480       -0.03565
C         -2.00882       -1.99129       -0.08755
C         -3.30409       -1.58306       -0.07693
C         -3.85337       -0.22813       -0.00862
C         -3.30072        1.01152        0.05781
C         -1.88260        1.25435        0.07263
C         -0.92785        0.24801        0.02134
C         -1.13674        2.47109        0.14752
C          2.77851       -0.20994        0.03363
H          3.05977       -2.25507        0.63890
H          6.66109       -0.02611        0.05983
H         -1.56912        3.46054        0.20669
H          2.86732        1.84686       -0.57311
H         -3.99060        2.79154        1.03157
H         -3.98529        2.88649       -0.72285
H         -5.24150        1.95006        0.10255
H         -4.93968       -0.23089       -0.01154
H         -1.82887       -3.06010       -0.13944
H          0.93117       -2.45058       -0.09008
H          1.01521        2.96892        0.20448
H         -3.96012       -3.64162       -0.18827
H         -5.02863       -2.57923        0.73817
H         -5.01551       -2.48847       -1.01596
H          5.50936       -2.14019        0.63805
H          5.32292        1.97007       -0.53775
        """
        self.geom['012_f_T1'] = """
C         -0.26068        2.21674        0.09688
C         -3.44951        0.95656       -0.30308
C         -0.41890        0.82388        0.02606
C         -4.83309        1.00705       -0.30636
C         -5.57736       -0.12854       -0.01372
C         -4.91989       -1.31596        0.28207
C         -3.53642       -1.36800        0.28673
C          4.40564       -2.59887       -0.11441
C          4.17632        2.26149        0.09958
C         -1.31761       -0.27023       -0.00516
C         -0.50832       -1.44740       -0.04698
C          0.87273       -1.12823       -0.04364
C          2.02952       -1.96718       -0.08141
C          3.32236       -1.54839       -0.06737
C          3.85943       -0.19210       -0.00897
C          3.29671        1.04496        0.04402
C          1.87912        1.27943        0.05053
C          0.92554        0.26421        0.00303
C          1.12902        2.48631        0.10974
C         -2.77202       -0.23203       -0.00620
H         -3.04180       -2.29680        0.53985
H         -6.65860       -0.08907       -0.01610
H          1.55463        3.47917        0.16192
H         -2.87859        1.84000       -0.55597
H          3.97225        2.91686       -0.75057
H          3.96993        2.83793        1.00459
H          5.23135        1.99689        0.08918
H          4.94574       -0.18593       -0.00705
H          1.85698       -3.03744       -0.12460
H         -0.89766       -2.45524       -0.09779
H         -1.02886        2.97123        0.14936
H          3.99170       -3.60413       -0.15632
H          5.04415       -2.45176       -0.98868
H          5.04796       -2.52648        0.76642
H         -5.48958       -2.20614        0.51631
H         -5.33451        1.93655       -0.54405
        """
        self.geom['013_g_S1'] = """
C         -2.51486        2.31481        0.15322
N         -2.34135        0.93103       -0.23837
C         -1.09794        0.37387       -0.06557
N          0.00973        1.14349        0.02960
C          1.10888        0.36197        0.12644
C          0.74054       -1.01115        0.09176
C         -0.74468       -1.00314       -0.02803
C         -1.17821       -2.31875       -0.05805
C         -0.01364       -3.12351        0.03388
C          1.15966       -2.33136        0.12430
N          2.35836        0.90577        0.29805
C          2.54725        2.28654       -0.09703
C          3.48377        0.02583        0.08094
C         -3.47639        0.06417       -0.01879
H         -1.69271        2.90904       -0.23508
H         -2.54035        2.43248        1.24475
H         -3.45228        2.68215       -0.26262
H         -2.18578       -2.69248       -0.13004
H         -0.01954       -4.20495        0.03489
H          2.16310       -2.71593        0.19694
H          1.73153        2.89076        0.28941
H          2.57446        2.40109       -1.18885
H          3.48850        2.64463        0.31824
H          3.59346       -0.26319       -0.97324
H          3.36816       -0.87609        0.67936
H          4.39423        0.53041        0.40074
H         -4.38131        0.57814       -0.33937
H         -3.58884       -0.22119        1.03609
H         -3.37113       -0.84037       -0.61518
        """
        self.geom['014_g_T1'] = """
C          5.10842       -6.12357       -4.66929
N          5.34308       -6.68491       -3.35508
C          5.29295       -5.83713       -2.27960
N          5.43209       -4.50176       -2.43285
C          5.40257       -3.90110       -1.22267
C          5.24229       -4.86322       -0.19128
C          5.15599       -6.17073       -0.90657
C          4.98532       -7.16948        0.04236
C          4.97085       -6.51391        1.30071
C          5.12781       -5.10956        1.16997
N          5.47124       -2.53759       -1.10450
C          6.00799       -1.78908       -2.22210
C          5.74029       -2.00454        0.21115
C          4.88443       -8.03907       -3.14685
H          5.67124       -5.20078       -4.77573
H          4.04647       -5.90106       -4.83657
H          5.44104       -6.83843       -5.42104
H          4.87597       -8.23054       -0.10381
H          4.85420       -7.02433        2.24780
H          5.15421       -4.41108        1.98887
H          5.57122       -2.15437       -3.14699
H          7.09915       -1.88580       -2.29427
H          5.75528       -0.73718       -2.09407
H          6.76409       -2.21510        0.54796
H          5.04235       -2.42819        0.93098
H          5.59455       -0.92552        0.19233
H          5.14169       -8.63784       -4.01931
H          3.79896       -8.09495       -2.98998
H          5.38447       -8.46954       -2.28120
        """
        return None
    

    def spin_init(self):
        for name in self.names:
            self.spin[name] = 0
        return None
    
    def charge_init(self):
        for name in self.names:
            self.charge[name] = 0
        return None
    

    

def check():
    geom = Adia7()
    names = geom.get_names()
    print('unit', geom.unit)
    print('number of molecules:', len(names))
    for name in names:
        print('name:', name)
        mol = geom.get_molecule(name, basis='sto-3g')
        print(mol.natm)
        print(mol.nao)
    return None


if __name__ == '__main__':
    check()
    pass